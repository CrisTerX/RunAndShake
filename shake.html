<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shake Tester</title>
</head>
<body>
<h1>ðŸ“± Shake Tester</h1>
<input type="text" id="unityIP" placeholder="IP Unity Server">
<button id="sendBtn">à¸ªà¹ˆà¸‡ shake</button>
<pre id="status"></pre>

<script>
const btn = document.getElementById('sendBtn');
const status = document.getElementById('status');

function sendShake(ip) {
    fetch(`http://${ip}:7070/shake`, { method: 'POST' })
    .then(res => res.text())
    .then(txt => status.textContent = 'ðŸ“© ' + txt)
    .catch(err => status.textContent = 'âŒ ' + err);
}

btn.addEventListener('click', () => {
    const ip = document.getElementById('unityIP').value;
    sendShake(ip);
});

// à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¹€à¸‚à¸¢à¹ˆà¸²
if(window.DeviceMotionEvent){
    let lastShake = 0;
    window.addEventListener('devicemotion', (event) => {
        const acc = event.accelerationIncludingGravity;
        const strength = Math.abs(acc.x)+Math.abs(acc.y)+Math.abs(acc.z);
        if(strength>30 && Date.now() - lastShake > 2000){
            lastShake = Date.now();
            const ip = document.getElementById('unityIP').value;
            sendShake(ip);
            status.textContent = `ðŸ“³ Shake detected! strength=${strength}`;
        }
    });
}
</script>
</body>
</html>
