<!DOCTYPE html>
<html>
<body>
<h2>Shake Test</h2>
<button id="shakeBtn">Simulate Shake</button>
<p id="status">Connecting...</p>

<script>
let ws;
const statusEl = document.getElementById('status');
const btn = document.getElementById('shakeBtn');

function connectWS() {
  const ip = prompt("Enter Node.js Bridge IP:", "192.168.1.206");
ws = new WebSocket(`ws://${ip}:9090`);


  ws.onopen = () => statusEl.innerText = "Connected!";
  ws.onerror = () => statusEl.innerText = "Error connecting";

  ws.onclose = () => statusEl.innerText = "Closed";
}

connectWS();

btn.addEventListener("click", () => {
  if(ws.readyState === WebSocket.OPEN) ws.send("shake");
});

// motion sensor
window.addEventListener('devicemotion', (event) => {
  const a = event.accelerationIncludingGravity;
  const total = Math.abs(a.x)+Math.abs(a.y)+Math.abs(a.z);
  if(total>20 && ws.readyState === WebSocket.OPEN) ws.send("shake");
});
</script>
</body>
</html>
