<!DOCTYPE html>
<html>
<body>
<h2>Shake Test</h2>
<button id="shakeBtn">Simulate Shake</button>
<p id="status">Connecting...</p>
<p id="motion">Motion Sensor: âŒ</p>
<p id="network">Network Test: âŒ</p>
<p id="ip"></p>

<script>
const statusEl = document.getElementById('status');
const motionEl = document.getElementById('motion');
const networkEl = document.getElementById('network');
const ipEl = document.getElementById('ip');
const btn = document.getElementById('shakeBtn');

let ws;

function connectWS() {
    const serverIP = prompt("Enter Unity Server IP:", "YOUR_PUBLIC_IP");
    ipEl.innerText = "Connecting to: " + serverIP;

    ws = new WebSocket(`ws://${serverIP}:9090`);

    ws.onopen = () => {
        statusEl.innerText = "âœ… Connected";
        networkEl.innerText = "Network Test: âœ…";
    };
    ws.onerror = (e) => {
        statusEl.innerText = "âŒ Connection Failed";
        networkEl.innerText = "Network Test: âŒ";
        console.error("WebSocket Error:", e);
    };
    ws.onclose = () => statusEl.innerText = "ğŸ”´ Closed";
}

connectWS();

btn.addEventListener("click", () => {
    if(ws.readyState === WebSocket.OPEN) ws.send("shake");
});

// Motion sensor
if(window.DeviceMotionEvent){
    motionEl.innerText = "Motion Sensor: âœ…";
    window.addEventListener('devicemotion', (event) => {
        const a = event.accelerationIncludingGravity;
        const total = Math.abs(a.x)+Math.abs(a.y)+Math.abs(a.z);
        if(total>20 && ws.readyState === WebSocket.OPEN) ws.send("shake");
    });
}else{
    motionEl.innerText = "Motion Sensor: âŒ";
}
</script>
</body>
</html>
